{"version":3,"file":"js/781.8ef89f77.js","mappings":"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","sources":["webpack://blogs/./src/views/htmlGame/TowerDefence.vue","webpack://blogs/./src/views/htmlGame/TowerDefence.vue?5bde"],"sourcesContent":["<template>\r\n  <div>\r\n    <!-- 塔防 -->\r\n    <canvas id=\"mycanvas\" width=\"800\" height=\"600\"></canvas>\r\n    <button class=\"btn-run\">开始</button>\r\n    <button class=\"btn-pause\">暂停</button>\r\n  </div>\r\n</template>\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      canvas: null,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.canvas = document.getElementById('mycanvas')\r\n    var ctx = this.canvas.getContext('2d')\r\n    const w = 600, h = 600\r\n    // 敌人的数据\r\n    const enemy = {\r\n      x: 50,\r\n      y: 50,\r\n      xy: 3, //xy 表示:1:左 2:下 3:右 4:上\r\n      speed: 2,\r\n    }\r\n    const tower = {\r\n      x: 200,\r\n      y: 200,\r\n      bulletSpeed: 8, //子弹的速度\r\n    }\r\n    const bulletArr = []\r\n    const xyArr = [\r\n      { x: 350, y: 350 },\r\n      { x: 50, y: 350 },\r\n      { x: 50, y: 50 },\r\n      { x: 350, y: 50 },\r\n    ]\r\n    function drawTower() {\r\n      ctx.font = '50px 宋体'\r\n      ctx.fillText('塔', tower.x, tower.y)\r\n    }\r\n    function drawEnemy() {\r\n      ctx.font = '50px 宋体'\r\n      ctx.fillText('敌', enemy.x, enemy.y)\r\n    }\r\n    var timer = 0\r\n    const shootFun = throttle(() => {\r\n      shootBullet()\r\n    })\r\n    \r\n    const draw = () => {\r\n      if (timer) cancelAnimationFrame(timer);\r\n        (function go() {\r\n          startDraw()\r\n          timer = requestAnimationFrame(go)\r\n        })()\r\n    }\r\n    draw()\r\n    function startDraw() {\r\n      ctx.clearRect(0, 0, w, h)\r\n      drawTower()\r\n      drawEnemy()\r\n      moveEnemy()\r\n      shootFun()\r\n      moveBullet()\r\n    }\r\n    function drawTower() {\r\n      ctx.font = '50px 宋体'\r\n      ctx.fillText('塔', tower.x, tower.y)\r\n    }\r\n    function drawEnemy() {\r\n      ctx.font = '50px 宋体'\r\n      ctx.fillText('敌', enemy.x, enemy.y)\r\n    }\r\n    \r\n    function moveEnemy() {\r\n      const { speed, xy, x, y } = enemy\r\n      for (let i = 0; i < xyArr.length; i++) {\r\n        if (x >= xyArr[i].x && x <= xyArr[i].x + speed && y >= xyArr[i].y && y <= xyArr[i].y + speed) {\r\n          if (i + 1 !== enemy.xy) {\r\n            enemy.xy = i + 1\r\n            break\r\n          }\r\n        }\r\n      }\r\n      switch (enemy.xy) {\r\n        case 1:\r\n          enemy.x -= speed\r\n          break\r\n        case 2:\r\n          enemy.y -= speed\r\n          break\r\n        case 3:\r\n          enemy.x += speed\r\n          break\r\n        case 4:\r\n          enemy.y += speed\r\n          break\r\n      }\r\n    }\r\n    // 发射子弹\r\n    function shootBullet() {\r\n      const size = 50\r\n      // 敌人中心\r\n      const ex = enemy.x + size / 2,\r\n        ey = enemy.y - size / 2\r\n      // 塔防中心,也是子弹的初始位置\r\n      const begin = { x: tower.x + size / 2, y: tower.y - size / 2 }\r\n      const diff = { x: ex - begin.x, y: ey - begin.y }\r\n      //子弹和敌人的距离\r\n      const distance = powAndSqrt(diff.x, diff.y)\r\n      const addX = (tower.bulletSpeed * diff.x) / distance\r\n      const addY = (tower.bulletSpeed * diff.y) / distance\r\n      bulletArr.push({\r\n        x: begin.x,\r\n        y: begin.y,\r\n        addX,\r\n        addY,\r\n        xy: 0,\r\n        distance,\r\n      })\r\n    }\r\n    // 移动子弹\r\n    function moveBullet() {\r\n      for (let i = bulletArr.length - 1; i >= 0; i--) {\r\n        const { addX, addY, distance } = bulletArr[i]\r\n        if (bulletArr[i].xy >= distance) {\r\n          bulletArr.splice(i, 1)\r\n        } else {\r\n          bulletArr[i].x += addX\r\n          bulletArr[i].y += addY\r\n          bulletArr[i].xy += tower.bulletSpeed\r\n          drawBullet(bulletArr[i])\r\n        }\r\n      }\r\n    }\r\n    // 画子弹\r\n    function drawBullet(bullet) {\r\n      ctx.save()\r\n      ctx.beginPath()\r\n      ctx.arc(bullet.x, bullet.y, 5, 0, 2 * Math.PI, false)\r\n      ctx.fillStyle = 'skyblue'\r\n      ctx.fill()\r\n      ctx.restore()\r\n    }\r\n    // 防抖\r\n    function throttle(fn) {\r\n      let timer = null\r\n      return () => {\r\n        if (timer) return\r\n        timer = setTimeout(() => {\r\n          fn()\r\n          clearTimeout(timer)\r\n          timer = null\r\n        }, 500)\r\n      }\r\n    }\r\n    document.querySelector('.btn-run').addEventListener('click', () => {\r\n      draw()\r\n    })\r\n    document.querySelector('.btn-pause').addEventListener('click', () => {\r\n      cancelAnimationFrame(timer)\r\n    })\r\n    // 两值相加并开平方 求斜边\r\n    function powAndSqrt(val1, val2) {\r\n      return Math.sqrt(Math.pow(val1, 2) + Math.pow(val2, 2))\r\n    }\r\n  },\r\n  methods: {},\r\n}\r\n</script>\r\n<style scoped>\r\n#mycanvas {\r\n  border: 1px solid #ccc;\r\n}\r\n</style>","import { render } from \"./TowerDefence.vue?vue&type=template&id=3c89fc52&scoped=true\"\nimport script from \"./TowerDefence.vue?vue&type=script&lang=js\"\nexport * from \"./TowerDefence.vue?vue&type=script&lang=js\"\n\nimport \"./TowerDefence.vue?vue&type=style&index=0&id=3c89fc52&scoped=true&lang=css\"\n\nimport exportComponent from \"D:\\\\项目\\\\blogs\\\\node_modules\\\\vue-loader\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-3c89fc52\"]])\n\nexport default __exports__"],"names":["_createElementVNode","id","width","height","class","_hoisted_1","_hoisted_2","_hoisted_3","_createElementBlock","data","canvas","mounted","this","document","getElementById","ctx","getContext","w","h","enemy","x","y","xy","speed","tower","bulletSpeed","bulletArr","xyArr","drawTower","font","fillText","drawEnemy","timer","shootFun","throttle","shootBullet","draw","cancelAnimationFrame","go","startDraw","requestAnimationFrame","clearRect","moveEnemy","moveBullet","i","length","size","ex","ey","begin","diff","distance","powAndSqrt","addX","addY","push","splice","drawBullet","bullet","save","beginPath","arc","Math","PI","fillStyle","fill","restore","fn","setTimeout","clearTimeout","val1","val2","sqrt","pow","querySelector","addEventListener","methods","__exports__","render"],"sourceRoot":""}